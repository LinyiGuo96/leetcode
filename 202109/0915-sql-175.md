**175. Combine Two Tables**

![image](https://user-images.githubusercontent.com/51500878/133527179-a0c4fee5-d4c1-49c7-8170-4e7e360f5f6e.png)

**Solution**

```sql
select a.FirstName, a.LastName, b.City, b.State 
from Person as a 
left join Address as b
on a.PersonId = b.PersonId
```

**176. Second Highest Salary**

![image](https://user-images.githubusercontent.com/51500878/133527287-d7fd334f-83b5-4fa3-9aa0-d9f56c4ba4ba.png)

**Solution**

```sql
select (select distinct Salary
          from Employee
          order by Salary DESC
          limit 1 offset 1) as SecondHighestSalary
```

**Note**

- To retrieve a portion of rows returned by a query, you use the LIMIT and OFFSET clauses.
```sql
SELECT 
    column_list
FROM
    table1
ORDER BY column_list
LIMIT row_count OFFSET offset;
```
  - The `row_count` determines the number of rows that will be returned.
  - The `OFFSET` clause skips the `offset` rows before beginning to return the rows. The `OFFSET` clause is _optional_ so you can skip it. If you use both `LIMIT` and `OFFSET` clauses the `OFFSET` skips `offset` rows first before the `LIMIT` constrains the number of rows.
- To order by variable in `descending`, put `DESC` **behind** the targeting variable

**177. Nth Highest Salary**

![image](https://user-images.githubusercontent.com/51500878/133528020-7109230a-eba0-4c28-94aa-755c446d490c.png)

**Solution**

```sql
CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT      # Define the function
BEGIN
DECLARE M INT;                                              #declaration_section
SET M = N-1;                                                #declaration_section
  RETURN (
      # Write your MySQL query statement below.             # executable_section
      select distinct salary                                # executable_section
      from Employee                                         # executable_section
      order by Salary DESC                                  # executable_section
      limit M, 1                                            # executable_section
  );
END
```

**Note**

- Still with `limit` in Mysql, `LIMIT [offset,] row_count;` is another way to express the line `LIMIT row_count OFFSET offset;` in the previous question
- The syntax to create a function in Mysql is 
```sql
CREATE FUNCTION function_name [ (parameter datatype [, parameter datatype]) ]
RETURNS return_datatype

BEGIN

   declaration_section

   executable_section

END;
```

